{"version":3,"sources":["s3sync.es6"],"names":[],"mappings":";;;;;;AAAA;;;;;;AAEA,IAAM,aAAa;AACjB,cAAY,EADK,EACG;AACpB,gBAAc,CAFG,EAEG;AACpB,gBAAc,IAHG,EAGG;AACpB,4BAA0B,QAJT,EAImB;AACpC,uBAAqB,QALJ,EAKc;AAC/B,aAAW;AACT;AACA;AACA,YAAQ;AAHC;AANM,CAAnB;;AAaA,IAAM,SAAS,YAAG,YAAH,CAAgB,UAAhB,CAAf;;AAEA,IAAM,SAAS,SAAT,MAAS,GAAsB;AAAA,MAArB,IAAqB,uEAAd,SAAc;;AACnC,MAAM,SAAS;AACb,cAAU,IADG;AAEb,oBAAgB,IAFH;;AAIb,cAAU;AACR,cAAQ,oBADA;AAER,cAAQ;AAFA;AAJG,GAAf;;AAUA,MAAM,WAAW,OAAO,SAAP,CAAiB,MAAjB,CAAjB;AACA,WAAS,EAAT,CAAY,OAAZ,EAAqB,eAAO;AAC1B,YAAQ,GAAR,CAAY,iBAAZ,EAA+B,IAAI,KAAnC;AACD,GAFD;AAGA,WAAS,EAAT,CAAY,UAAZ,EAAwB;AAAA,WACtB,QAAQ,GAAR,gBAAyB,SAAS,cAAlC,WAAsD,SAAS,aAA/D,OADsB;AAAA,GAAxB;AAGA,WAAS,EAAT,CAAY,KAAZ,EAAmB;AAAA,WACjB,QAAQ,GAAR,CAAY,gBAAZ,CADiB;AAAA,GAAnB;;AAIA,UAAQ,GAAR,gBAAyB,KAAK,SAAL,CAAe,MAAf,CAAzB;AACA,SAAO,QAAQ,OAAR,EAAP;AACD,CAxBD;;kBA0Be,M","file":"s3sync.js","sourcesContent":["import s3 from 's3';\n\nconst initParams = {\n  maxAsyncS3: 20,     // this is the default\n  s3RetryCount: 3,    // this is the default\n  s3RetryDelay: 1000, // this is the default\n  multipartUploadThreshold: 20971520, // this is the default (20 MB)\n  multipartUploadSize: 15728640, // this is the default (15 MB)\n  s3Options: {\n    // any other options are passed to new AWS.S3()\n    // See: http://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/Config.html#constructor-property\n    region: 'ap-northeast-1',\n  },\n};\n\nconst client = s3.createClient(initParams);\n\nconst s3sync = (from = './build') => {\n  const params = {\n    localDir: from,\n    deletedRemoved: true,\n\n    s3Params: {\n      Bucket: 'markdown-converter',\n      Prefix: 'artifacts',\n    },\n  };\n\n  const uploader = client.uploadDir(params);\n  uploader.on('error', err => {\n    console.log('unable to sync:', err.stack);\n  });\n  uploader.on('progress', () =>\n    console.log(`progress: ${uploader.progressAmount} / ${uploader.progressTotal})`)\n  );\n  uploader.on('end', () =>\n    console.log('done uploading')\n  );\n\n  console.log(`client is ${JSON.stringify(client)}`);\n  return Promise.resolve();\n};\n\nexport default s3sync;\n\n\n"]}